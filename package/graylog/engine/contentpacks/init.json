{
    "name":"Init",
    "description":"Some Graylog bootstrap",
    "category":"Common",
    "inputs":[
        {
            "id": "5bf579a48b87bc0001ab2d67",
            "title": "Input Syslog over UDP",
            "configuration": {
                "expand_structured_data":false,
                "recv_buffer_size":262144,
                "port":514,
                "override_source":null,
                "force_rdns":false,
                "allow_override_date":true,
                "bind_address":"0.0.0.0",
                "store_full_message":false
            },
            "static_fields":{},
            "type":"org.graylog2.inputs.syslog.udp.SyslogUDPInput",
            "global":true,
            "extractors":[]
        },
        {
            "id":"5bf579788b87bc0001ab2d33",
            "title":"Input Syslog over TCP",
            "configuration":{
                "recv_buffer_size":1048576,
                "tcp_keepalive":false,
                "use_null_delimiter":false,
                "tls_client_auth_cert_file":"",
                "force_rdns":false,
                "bind_address":"0.0.0.0",
                "tls_cert_file":"",
                "store_full_message":false,
                "expand_structured_data":false,
                "port":514,
                "tls_key_file":"",
                "tls_enable":false,
                "tls_key_password":"",
                "max_message_size":2097152,
                "tls_client_auth":"disabled",
                "override_source":null,
                "allow_override_date":true
            },
            "static_fields":{},
            "type":"org.graylog2.inputs.syslog.tcp.SyslogTCPInput",
            "global":true,
            "extractors":[]
        },
        {
            "id":"5bffc3841aa80a00013f366c",
            "title":"Internal",
            "configuration":{
                "recv_buffer_size":1048576,
                "tcp_keepalive":false,
                "use_null_delimiter":false,
                "tls_client_auth_cert_file":"",
                "force_rdns":true,
                "bind_address":"0.0.0.0",
                "tls_cert_file":"",
                "store_full_message":true,
                "expand_structured_data":false,
                "port":1514,
                "tls_key_file":"",
                "tls_enable":false,
                "tls_key_password":"",
                "max_message_size":2097152,
                "tls_client_auth":"disabled",
                "override_source":null,
                "allow_override_date":false
            },
            "static_fields":{},
            "type":"org.graylog2.inputs.syslog.tcp.SyslogTCPInput",
            "global":true,
            "extractors":[]
        }
    ],
    "streams":[

    ],
    "outputs":[

    ],
    "dashboards":[

    ],
    "grok_patterns" : [
        {
            "name" : "SYSLOGPROG",
            "pattern" : "%{PROG:program}(?:\\[%{POSINT:pid}\\])?"
        }, {
            "name" : "PROG",
            "pattern" : "(?:[\\w._/%-]+)"
        }, {
            "name" : "SYSLOGFACILITY",
            "pattern" : "<%{NONNEGINT:facility}.%{NONNEGINT:priority}>"
        }, {
            "name" : "SYSLOGHOST",
            "pattern" : "%{IPORHOST}"
        }, {
            "name" : "DATESTAMP_OTHER",
            "pattern" : "%{DAY} %{MONTH} %{MONTHDAY} %{TIME} %{TZ} %{YEAR}"
        }, {
            "name" : "BASE16FLOAT",
            "pattern" : "\\b(?<![0-9A-Fa-f.])(?:[+-]?(?:0x)?(?:(?:[0-9A-Fa-f]+(?:\\.[0-9A-Fa-f]*)?)|(?:\\.[0-9A-Fa-f]+)))\\b"
        }, {
            "name" : "DATESTAMP_RFC2822",
            "pattern" : "%{DAY}, %{MONTHDAY} %{MONTH} %{YEAR} %{TIME} %{ISO8601_TIMEZONE}"
        }, {
            "name" : "SYSLOGTIMESTAMP",
            "pattern" : "%{MONTH} +%{MONTHDAY} %{TIME}"
        }, {
            "name" : "DATESTAMP_EVENTLOG",
            "pattern" : "%{YEAR}%{MONTHNUM2}%{MONTHDAY}%{HOUR}%{MINUTE}%{SECOND}"
        }, {
            "name" : "COMMA",
            "pattern" : ","
        }, {
            "name" : "HTTPDATE",
            "pattern" : "%{MONTHDAY}/%{MONTH}/%{YEAR}:%{TIME} %{INT}"
        }, {
            "name" : "URI",
            "pattern" : "%{URIPROTO}://(?:%{USER}(?::[^@]*)?@)?(?:%{URIHOST})?(?:%{URIPATHPARAM})?"
        }, {
            "name" : "URIPATHPARAM",
            "pattern" : "%{URIPATH}(?:%{URIPARAM})?"
        }, {
            "name" : "MONTHNUM",
            "pattern" : "(?:0?[1-9]|1[0-2])"
        }, {
            "name" : "MONTH",
            "pattern" : "\\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sep(?:tember)?|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)\\b"
        }, {
            "name" : "WINDNS_THREADID",
            "pattern" : "[a-zA-Z0-9]{4}"
        }, {
            "name" : "URIPARAM",
            "pattern" : "\\?[A-Za-z0-9$.+!*'|(){},~@#%&/=:;_?\\-\\[\\]]*"
        }, {
            "name" : "URIPATH",
            "pattern" : "(?:/[A-Za-z0-9$.+!*'(){},~:;=@#%_\\-]*)+"
        }, {
            "name" : "BASE10NUM",
            "pattern" : "(?<![0-9.+-])(?>[+-]?(?:(?:[0-9]+(?:\\.[0-9]+)?)|(?:\\.[0-9]+)))"
        }, {
            "name" : "INT",
            "pattern" : "(?:[+-]?(?:[0-9]+))"
        }, {
            "name" : "BASE16NUM",
            "pattern" : "(?<![0-9A-Fa-f])(?:[+-]?(?:0x)?(?:[0-9A-Fa-f]+))"
        }, {
            "name" : "DATESTAMP_RFC822",
            "pattern" : "%{DAY} %{MONTH} %{MONTHDAY} %{YEAR} %{TIME} %{TZ}"
        }, {
            "name" : "NUMBER",
            "pattern" : "(?:%{BASE10NUM})"
        }, {
            "name" : "USER",
            "pattern" : "%{USERNAME}"
        }, {
            "name" : "NOTSPACE",
            "pattern" : "\\S+"
        }, {
            "name" : "WORD",
            "pattern" : "\\b\\w+\\b"
        }, {
            "name" : "WORDSWITHDASH",
            "pattern" : "([A-Za-z0-9\\-\\_]+)"
        }, {
            "name" : "DATA",
            "pattern" : ".*?"
        }, {
            "name" : "SPACE",
            "pattern" : "\\s*"
        }, {
            "name" : "NONNEGINT",
            "pattern" : "\\b(?:[0-9]+)\\b"
        }, {
            "name" : "POSINT",
            "pattern" : "\\b(?:[1-9][0-9]*)\\b"
        }, {
            "name" : "WINDNS_RESPONSE",
            "pattern" : "([A-Z]+)"
        }, {
            "name" : "QSORNC",
            "pattern" : "(%{QUOTEDQUOTES}|%{NOTCOMMA})"
        }, {
            "name" : "QUOTEDSTRING",
            "pattern" : "(?>(?<!\\\\)(?>\"(?>\\\\.|[^\\\\\"]+)+\"|\"\"|(?>'(?>\\\\.|[^\\\\']+)+')|''|(?>`(?>\\\\.|[^\\\\`]+)+`)|``))"
        }, {
            "name" : "GREEDYDATA",
            "pattern" : ".*"
        }, {
            "name" : "MAC",
            "pattern" : "(?:%{CISCOMAC}|%{WINDOWSMAC}|%{COMMONMAC})"
        }, {
            "name" : "UUID",
            "pattern" : "[A-Fa-f0-9]{8}-(?:[A-Fa-f0-9]{4}-){3}[A-Fa-f0-9]{12}"
        }, {
            "name" : "DATESTAMP",
            "pattern" : "%{DATE}[- ]%{TIME}"
        }, {
            "name" : "DATE",
            "pattern" : "%{DATE_US}|%{DATE_EU}"
        }, {
            "name" : "NOTCOMMA",
            "pattern" : "[^,]+"
        }, {
            "name" : "TZ",
            "pattern" : "(?:[PMCE][SD]T|UTC)"
        }, {
            "name" : "ISO8601_TIMEZONE",
            "pattern" : "(?:Z|[+-]%{HOUR}(?::?%{MINUTE}))"
        }, {
            "name" : "WINDNS_FLAGSHEX",
            "pattern" : "([0-9]+)"
        }, {
            "name" : "TIMESTAMP_ISO8601",
            "pattern" : "%{YEAR}-%{MONTHNUM}-%{MONTHDAY}[T ]%{HOUR}:?%{MINUTE}(?::?%{SECOND})?%{ISO8601_TIMEZONE}?"
        }, {
            "name" : "ISO8601_SECOND",
            "pattern" : "(?:%{SECOND}|60)"
        }, {
            "name" : "PROTOCOL",
            "pattern" : "(TCP|UDP|ICMP)"
        }, {
            "name" : "QUOTEDQUOTES",
            "pattern" : "(\"((?:[^\"]|\"\")*+)\")"
        }, {
            "name" : "DATE_US2",
            "pattern" : "%{YEAR}[/-]%{MONTHNUM}[/-]%{MONTHDAY}"
        }, {
            "name" : "PATH",
            "pattern" : "(?:%{UNIXPATH}|%{WINPATH})"
        }, {
            "name" : "WINDNS_TIME",
            "pattern" : "(?:0?[1-9]|1[0-2])[/-](?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9])[/-](?>\\d\\d){1,2}\\s(?!<[0-9])(?:2[0123]|[01]?[0-9]):(?:[0-5][0-9]):(?:(?:[0-5]?[0-9]|60)(?:[:.,][0-9]+)?)\\s(A|P)M"
        }, {
            "name" : "HOSTPORT",
            "pattern" : "%{IPORHOST}:%{POSINT}"
        }, {
            "name" : "TTY",
            "pattern" : "(?:/dev/(pts|tty([pq])?)(\\w+)?/?(?:[0-9]+))"
        }, {
            "name" : "UNIXPATH",
            "pattern" : "(?>/(?>[\\w_%!$@:.,-]+|\\\\.)*)+"
        }, {
            "name" : "HOSTNAME",
            "pattern" : "\\b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\\.?|\\b)"
        }, {
            "name" : "IPORHOST",
            "pattern" : "(?:%{HOSTNAME}|%{IP})"
        }, {
            "name" : "HOST",
            "pattern" : "%{HOSTNAME}"
        }, {
            "name" : "URIPROTO",
            "pattern" : "[A-Za-z]+(\\+[A-Za-z+]+)?"
        }, {
            "name" : "WINPATH",
            "pattern" : "(?>[A-Za-z]+:|\\\\)(?:\\\\[^\\\\?*]*)+"
        }, {
            "name" : "WINDNS_SNDRCV",
            "pattern" : "(Snd|Rcv)"
        }, {
            "name" : "URIHOST",
            "pattern" : "%{IPORHOST}(?::%{POSINT:port})?"
        }, {
            "name" : "LOGLEVEL",
            "pattern" : "([A|a]lert|ALERT|[T|t]race|TRACE|[D|d]ebug|DEBUG|[N|n]otice|NOTICE|[I|i]nfo|INFO|[W|w]arn?(?:ing)?|WARN?(?:ING)?|[E|e]rr?(?:or)?|ERR?(?:OR)?|[C|c]rit?(?:ical)?|CRIT?(?:ICAL)?|[F|f]atal|FATAL|[S|s]evere|SEVERE|EMERG(?:ENCY)?|[Ee]merg(?:ency)?)"
        }, {
            "name" : "WINDNS_OPCODE",
            "pattern" : "([A-Z]{1})"
        }, {
            "name" : "QUOTES",
            "pattern" : "/\"(.+)\"/"
        }, {
            "name" : "SYSLOGBASE",
            "pattern" : "%{SYSLOGTIMESTAMP:timestamp} (?:%{SYSLOGFACILITY} )?%{SYSLOGHOST:logsource} %{SYSLOGPROG}:"
        }, {
            "name" : "QS",
            "pattern" : "%{QUOTEDSTRING}"
        }, {
            "name" : "COMBINEDAPACHELOG",
            "pattern" : "%{COMMONAPACHELOG} %{QS:referrer} %{QS:agent}"
        }, {
            "name" : "COMMONAPACHELOG",
            "pattern" : "%{IPORHOST:clientip} %{USER:ident} %{USER:auth} \\[%{HTTPDATE:timestamp}\\] \"(?:%{WORD:verb} %{NOTSPACE:request}(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest})\" %{NUMBER:response} (?:%{NUMBER:bytes}|-)"
        }, {
            "name" : "WINDNS_XID",
            "pattern" : "([a-z0-9]{4})"
        }, {
            "name" : "MINUTE",
            "pattern" : "(?:[0-5][0-9])"
        }, {
            "name" : "HOUR",
            "pattern" : "(?:2[0123]|[01]?[0-9])"
        }, {
            "name" : "WINDNS_IP",
            "pattern" : "(?<![0-9])(?:(?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2}))(?![0-9])|((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?"
        }, {
            "name" : "TIME",
            "pattern" : "(?!<[0-9])%{HOUR}:%{MINUTE}(?::%{SECOND})(?![0-9])"
        }, {
            "name" : "SECOND",
            "pattern" : "(?:[0-5][0-9])"
        }, {
            "name" : "MONTHDAY",
            "pattern" : "(?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9])"
        }, {
            "name" : "WINDNS_PROTOCOL",
            "pattern" : "(UDP|TCP)"
        }, {
            "name" : "MONTHNUM2",
            "pattern" : "(?:0[1-9]|1[0-2])"
        }, {
            "name" : "WINDNS_FLAGSCHAR",
            "pattern" : "(\\s+[A|T|D|R]{1,4}\\s+)|(\\s+[A|T|D|R]{1,4}\\s+[A|T|D|R]{1,4}\\s+)|(\\s+[A|T|D|R]{1,4}\\s+[A|T|D|R]{1,4}\\s+[A|T|D|R]{1,4}\\s+)|\\s+"
        }, {
            "name" : "YEAR",
            "pattern" : "(?>\\d\\d){1,2}"
        }, {
            "name" : "DAY",
            "pattern" : "(?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?)"
        }, {
            "name" : "DATE_EU",
            "pattern" : "%{MONTHDAY}[./-]%{MONTHNUM}[./-]%{YEAR}"
        }, {
            "name" : "WINDNS_QUERYRESP",
            "pattern" : "(\\s+R\\s+|\\s+)"
        }, {
            "name" : "DATE_US",
            "pattern" : "%{MONTHNUM}[/-]%{MONTHDAY}[/-]%{YEAR}"
        }, {
            "name" : "WINDNS_NAME",
            "pattern" : "(?:\\s+.+|)"
        }, {
            "name" : "WINDNS_QTYPE",
            "pattern" : "(?:\\s\\S+|)"
        }, {
            "name" : "COMMONMAC",
            "pattern" : "(?:(?:[A-Fa-f0-9]{2}:){5}[A-Fa-f0-9]{2})"
        }, {
            "name" : "WINDOWSMAC",
            "pattern" : "(?:(?:[A-Fa-f0-9]{2}-){5}[A-Fa-f0-9]{2})"
        }, {
            "name" : "IPV4",
            "pattern" : "(?<![0-9])(?:(?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2}))(?![0-9])"
        }, {
            "name" : "IPV6",
            "pattern" : "((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?"
        }, {
            "name" : "CISCOMAC",
            "pattern" : "(?:(?:[A-Fa-f0-9]{4}\\.){2}[A-Fa-f0-9]{4})"
        }, {
            "name" : "USERNAME",
            "pattern" : "[a-zA-Z0-9._-]+"
        }, {
            "name" : "IP",
            "pattern" : "(?:%{IPV6}|%{IPV4})"
        }
    ],
    "lookup_tables":[
        {
            "title":"GeoIP City Lookup Table",
            "description":"Retrieve Geolocation of public IPs",
            "name":"geoip-city-lookup-table",
            "cache_name":"geoip-city-cache",
            "data_adapter_name":"geoip-city-database",
            "default_single_value":"",
            "default_single_value_type":"NULL",
            "default_multi_value":"",
            "default_multi_value_type":"NULL"
        }
    ],
    "lookup_caches":[
        {
            "title":"GeoIP City Cache",
            "description":"GeoIP cache for IP -> City, Country association from MaxMind DB",
            "name":"geoip-city-cache",
            "config":{
                "type":"guava_cache",
                "max_size":1000,
                "expire_after_access":6,
                "expire_after_access_unit":"HOURS",
                "expire_after_write":0,
                "expire_after_write_unit":null
            }
        }
    ],
    "lookup_data_adapters":[
        {
            "title":"GeoIP City Database",
            "description":"Public IP -> City, Country Adapter",
            "name":"geoip-city-database",
            "config":{
                "type":"maxmind_geoip",
                "path":"/etc/graylog/server/GeoLite2-City.mmdb",
                "database_type":"MAXMIND_CITY",
                "check_interval":1,
                "check_interval_unit":"HOURS"
            }
          }
    ]
}